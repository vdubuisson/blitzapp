import{a as oe,b as te,c as ie}from"./chunk-K3K2MGLD.js";import"./chunk-UISL6Y2D.js";import{a as H}from"./chunk-BIJCMJ4Z.js";import"./chunk-GLIKPMAE.js";import{a as z,b,c as X,d as $,e as q,f as J,g as Y,h as K,i as Q,j as W,k as Z,l as ee}from"./chunk-UR35O2SI.js";import{b as w,d as N}from"./chunk-IZXJ5OQA.js";import"./chunk-U4UTBI7T.js";import{a as O,b as j,c as v}from"./chunk-U2Q7NHL3.js";import"./chunk-AWSUHQ36.js";import{d as D}from"./chunk-ZP7N7TL4.js";import"./chunk-I2GCBKKZ.js";import{Ib as u,Jb as E,Kb as V,Mb as M,Na as i,Ob as p,Pb as s,W as C,Yb as g,_a as G,ba as I,bb as L,ca as F,hc as B,kb as l,mc as k,ob as y,pb as S,qb as P,rb as r,sb as a,tb as R,ub as T,vb as x,wb as U,yb as d,zb as h}from"./chunk-GNHLBSKU.js";import"./chunk-NWM22BJ3.js";import"./chunk-7CGTOI24.js";var f=(m=>(m.CORE="CORE",m.LUNE="LUNE",m.VILLAGE="VILLAGE",m.PERSONNAGES="PERSONNAGES",m.PACTE="PACTE",m))(f||{});var re={CORE:["CHASSEUR","CUPIDON","PETITE_FILLE","SORCIERE","VOLEUR","VOYANTE"],LUNE:["JOUEUR_FLUTE","SALVATEUR","ANCIEN","IDIOT","BOUC"],VILLAGE:["CORBEAU","LOUP_BLANC"],PERSONNAGES:["CHIEN_LOUP","SOEUR","FRERE","ENFANT_SAUVAGE","GRAND_MECHANT_LOUP","MONTREUR_OURS","RENARD","ANGE","CHEVALIER","SECTAIRE","PERE_LOUPS"],PACTE:Object.values(O).filter(n=>!["NOT_SELECTED","VILLAGEOIS","LOUP_GAROU"].includes(n))};var ne={CORE:"Boite de base",LUNE:"Extension - Nouvelle lune",VILLAGE:"Extension - Village",PERSONNAGES:"Extension - Personnages",PACTE:"Le Pacte"};var _=class n{transform(t){return ne[t]}static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275pipe=L({name:"gameBoxName",type:n,pure:!0})}};function ae(n,t){if(n&1){let o=U();r(0,"label",14),R(1,"img",4),p(2,"playerRoleImage"),p(3,"playerRoleName"),r(4,"span"),u(5),p(6,"playerRoleName"),a(),r(7,"input",15,0),d("change",function(){let c=I(o).$implicit,m=h(2);return F(m.onRoleCheckChange(c))}),a()()}if(n&2){let o=t.$implicit,e=h().$implicit,c=h();l("for",e+"-"+o),i(),l("ngSrc",s(2,9,o))("alt",s(3,11,o))("width",55)("height",55),i(4),E(s(6,13,o)),i(2),l("id",e+"-"+o)("value",o)("checked",c.selectedRoles().has(o))}}function pe(n,t){if(n&1&&(r(0,"lgmj-accordion-item",9),T(1,13),r(2,"strong"),u(3),p(4,"gameBoxName"),p(5,"uppercase"),a(),x(),S(6,ae,9,15,"label",14,y),a()),n&2){let o=t.$implicit,e=h();l("noInnerPadding",!0)("headerColor","light"),i(3),E(s(5,5,s(4,3,o))),i(3),P(e.boxContents[o])}}var A=class n{constructor(){this.playerRoleNamePipe=C(v);this.cardChoiceState=C(w).state;this.router=C(D);this.formBuilder=C(W);this.boxContents=re;this.boxes=Object.values(f);this.loupGarouRole="LOUP_GAROU";this.villageoisRole="VILLAGEOIS";this.selectedRoles=g(()=>{let t=this.rolesSelectionChange()?.source?.selected??[];return new Set(t)});this.rolesSelection=new H(!0);this.rolesSelectionChange=N(this.rolesSelection.changed);this.requiredVillageois=g(()=>this.selectedRoles().has("VOLEUR")?2:0);this.roleCountForm=this.formBuilder.group({loupGarou:[0,b.min(0)],villageois:[0,b.min(this.requiredVillageois())]});this.roleCountFormChanges=N(this.roleCountForm.valueChanges);this.villageoisCount=g(()=>this.roleCountFormChanges()?.villageois??0);this.loupGarouCount=g(()=>this.roleCountFormChanges()?.loupGarou??0);this.playersCount=g(()=>this.selectedRoles().size+this.villageoisCount()+this.loupGarouCount()+(this.selectedRoles().has("SOEUR")?1:0)+(this.selectedRoles().has("FRERE")?2:0)-(this.selectedRoles().has("VOLEUR")?2:0))}ngOnInit(){Object.values(this.boxContents).forEach(o=>{o.sort((e,c)=>this.playerRoleNamePipe.transform(e).localeCompare(this.playerRoleNamePipe.transform(c)))});let t=this.cardChoiceState();this.rolesSelection.setSelection(...t.selectedRoles),this.roleCountForm.patchValue(t)}onRoleCheckChange(t){if(this.rolesSelection.toggle(t),t==="VOLEUR"){let o=this.roleCountForm.value.villageois??0;this.rolesSelection.isSelected(t)?this.roleCountForm.patchValue({villageois:o+2}):this.roleCountForm.patchValue({villageois:Math.max(o-2,0)})}}validateRoles(){let t={selectedRoles:this.selectedRoles(),playersNumber:this.playersCount(),villageois:this.roleCountForm.value.villageois??0,loupGarou:this.roleCountForm.value.loupGarou??0};this.cardChoiceState.set(t),this.router.navigate(["new-game"])}deselectAll(){this.rolesSelection.clear(),this.roleCountForm.patchValue({villageois:0,loupGarou:0})}selectInput(t){t.target.select()}static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275cmp=G({type:n,selectors:[["lgmj-roles-choice"]],features:[M([v])],decls:26,vars:31,consts:[["checkbox",""],[1,"form-container"],[3,"submit","formGroup"],[1,"form-group"],[1,"role-img",3,"ngSrc","alt","width","height"],["for","loupGarou"],["type","number",1,"form-control",3,"focus","formControl","min"],["for","villageois"],[3,"multi"],[3,"noInnerPadding","headerColor"],[1,"submit-block"],["type","submit",1,"btn","primary",3,"disabled"],["type","button",1,"btn","danger",3,"click","disabled"],["header",""],[1,"form-group",3,"for"],["type","checkbox",1,"form-control",3,"change","id","value","checked"]],template:function(o,e){o&1&&(r(0,"main",1)(1,"form",2),d("submit",function(){return e.validateRoles()}),r(2,"div",3),R(3,"img",4),p(4,"playerRoleImage"),p(5,"playerRoleName"),r(6,"label",5),u(7),p(8,"playerRoleName"),a(),r(9,"input",6),d("focus",function(m){return e.selectInput(m)}),a()(),r(10,"div",3),R(11,"img",4),p(12,"playerRoleImage"),p(13,"playerRoleName"),r(14,"label",7),u(15),p(16,"playerRoleName"),a(),r(17,"input",6),d("focus",function(m){return e.selectInput(m)}),a()(),r(18,"cdk-accordion",8),S(19,pe,8,7,"lgmj-accordion-item",9,y),a(),r(21,"section",10)(22,"button",11),u(23),a(),r(24,"button",12),d("click",function(){return e.deselectAll()}),u(25," D\xC9S\xC9LECTIONNER TOUT "),a()()()()),o&2&&(i(),l("formGroup",e.roleCountForm),i(2),l("ngSrc",s(4,19,e.loupGarouRole))("alt",s(5,21,e.loupGarouRole))("width",55)("height",55),i(4),E(s(8,23,e.loupGarouRole)),i(2),l("formControl",e.roleCountForm.controls.loupGarou)("min",0),i(2),l("ngSrc",s(12,25,e.villageoisRole))("alt",s(13,27,e.villageoisRole))("width",55)("height",55),i(4),E(s(16,29,e.villageoisRole)),i(2),l("formControl",e.roleCountForm.controls.villageois)("min",e.requiredVillageois()),i(),l("multi",!0),i(),P(e.boxes),i(3),l("disabled",e.playersCount()<=0||e.roleCountForm.invalid),i(),V(" VALIDER (",e.playersCount()," JOUEURS) "),i(),l("disabled",e.playersCount()<=0))},dependencies:[v,j,_,B,Z,q,z,J,X,$,Q,ee,Y,K,k,ie,te,oe],styles:[".form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{align-items:center;display:flex;gap:var(--spacing-1);padding:var(--spacing-1)}.form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]:not(:last-child){border-bottom:1px solid var(--light-border-color)}.form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input.form-control[_ngcontent-%COMP%]{margin-left:auto}.form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input.form-control[type=number][_ngcontent-%COMP%]{border-radius:var(--input-radius);border:1px solid var(--main-text-color);font-size:var(--font-size-m);height:1rem;padding:var(--spacing-05);text-align:end;width:2rem}.form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input.form-control[type=checkbox][_ngcontent-%COMP%]{height:1.25rem;width:1.25rem}"],changeDetection:0})}};export{A as default};
