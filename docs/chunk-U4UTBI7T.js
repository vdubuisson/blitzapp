import{Q as s,j as n,o}from"./chunk-GNHLBSKU.js";import{a}from"./chunk-NWM22BJ3.js";var i=a("Preferences",{web:()=>import("./chunk-7EBWE6BC.js").then(r=>new r.PreferencesWeb)});var c=class r{constructor(){this.actionQueue=[];this.actionInProgress=!1}set(e,t){this.actionQueue.push({type:"SET",key:e,value:t}),this.actionInProgress||this.handleNextAction()}get(e){return n(i.get({key:e})).pipe(o(({value:t})=>t?JSON.parse(t):null))}remove(e){this.actionQueue.push({type:"REMOVE",key:e}),this.actionInProgress||this.handleNextAction()}clear(){return n(i.clear())}async handleNextAction(){this.actionInProgress=!0;let e=this.actionQueue.shift();if(e!==void 0)if(e.type==="SET"){let t=JSON.stringify(e.value);await i.set({key:e.key,value:t})}else await i.remove({key:e.key});this.actionQueue.length>0?await this.handleNextAction():this.actionInProgress=!1}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=s({token:r,factory:r.\u0275fac,providedIn:"root"})}};export{c as a};
