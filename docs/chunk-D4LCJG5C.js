import{j as m,n as d}from"./chunk-KXDRYK6V.js";import{d as p}from"./chunk-ZP7N7TL4.js";import{Q as y,W as n,pa as c}from"./chunk-GNHLBSKU.js";import{a as l,b as i}from"./chunk-7CGTOI24.js";var P=class o{constructor(){this.gameService=n(d);this.router=n(p);this.currentGamePlayers=n(m).state.asReadonly();this.players=c([]);this.currentPlayers=this.players.asReadonly()}addPlayer(a){let e=this.players(),r={id:e.length,name:a,role:"NOT_SELECTED",card:"NOT_SELECTED",statuses:new Set,isDead:!1};this.players.set([...e,r])}removePlayer(a){let e=this.players();e.splice(a,1);let r=this.reindexPlayers(e);this.players.set(r)}reorderPlayers(a,e){let r=this.players(),t=r.splice(a,1)[0];r.splice(e,0,t);let s=this.reindexPlayers(r);this.players.set(s)}replay(){let e=[...this.currentGamePlayers()].map(r=>i(l({},r),{role:"NOT_SELECTED",card:"NOT_SELECTED",statuses:new Set,isDead:!1}));this.players.set(e),this.router.navigate(["roles-choice"])}changeRole(a,e){let r=[...this.players()],t=r.findIndex(s=>s.id===a);if(t>-1){let s=i(l({},r[t]),{role:e,card:e});r[t]=s,this.players.set(r)}}createGame(){this.gameService.createGame(this.players()),this.players.set([])}reindexPlayers(a){return[...a].map((e,r)=>i(l({},e),{id:r}))}static{this.\u0275fac=function(e){return new(e||o)}}static{this.\u0275prov=y({token:o,factory:o.\u0275fac,providedIn:"root"})}};export{P as a};
