import{a as oe,b as ie,c as re}from"./chunk-X5H27IGT.js";import{a as q}from"./chunk-H7XIX35G.js";import"./chunk-4JLUOYQS.js";import{a as z,b,c as X,d as $,e as J,f as Y,g as K,h as Q,i as W,j as Z,k as ee,l as te}from"./chunk-2MS6TCI3.js";import{b as j,d as O}from"./chunk-EFH6HX73.js";import"./chunk-ZM6HYW2V.js";import{a as P,b as H,c as v}from"./chunk-F5TIAXDW.js";import"./chunk-6TFKRWKD.js";import{b as D,d as k}from"./chunk-J6W7A42Q.js";import{Ab as C,Ba as L,Pa as _,Pb as B,Qa as S,Ra as N,Rb as w,Sa as l,Ta as r,Ua as a,V as d,Va as E,Ya as T,Z as A,Za as M,_ as I,_a as x,ab as g,cb as f,pa as i,pb as u,qb as R,rb as U,tb as V,vb as s,wb as p,ya as F}from"./chunk-FDHCW5RC.js";import"./chunk-HMLYRQFI.js";import"./chunk-2NFLSA4Y.js";var h=(m=>(m.CORE="CORE",m.LUNE="LUNE",m.VILLAGE="VILLAGE",m.PERSONNAGES="PERSONNAGES",m.PACTE="PACTE",m))(h||{});var ne={CORE:["CHASSEUR","CUPIDON","PETITE_FILLE","SORCIERE","VOLEUR","VOYANTE"],LUNE:["JOUEUR_FLUTE","SALVATEUR","ANCIEN","IDIOT","BOUC"],VILLAGE:["CORBEAU","LOUP_BLANC"],PERSONNAGES:["CHIEN_LOUP","SOEUR","FRERE","ENFANT_SAUVAGE","GRAND_MECHANT_LOUP","MONTREUR_OURS","RENARD","ANGE","CHEVALIER","SECTAIRE","PERE_LOUPS"],PACTE:Object.values(P).filter(n=>!["NOT_SELECTED","VILLAGEOIS","LOUP_GAROU"].includes(n))};var le={CORE:"Boite de base",LUNE:"Extension - Nouvelle lune",VILLAGE:"Extension - Village",PERSONNAGES:"Extension - Personnages",PACTE:"Le Pacte"};var y=class n{transform(o){return le[o]}static \u0275fac=function(t){return new(t||n)};static \u0275pipe=L({name:"gameBoxName",type:n,pure:!0})};function se(n,o){if(n&1){let t=x();r(0,"label",14),E(1,"img",4),s(2,"playerRoleImage"),s(3,"playerRoleName"),r(4,"span"),u(5),s(6,"playerRoleName"),a(),r(7,"input",15,0),g("change",function(){let c=A(t).$implicit,m=f(2);return I(m.onRoleCheckChange(c))}),a()()}if(n&2){let t=o.$implicit,e=f().$implicit,c=f();l("for",e+"-"+t),i(),l("ngSrc",p(2,9,t))("alt",p(3,11,t))("width",55)("height",55),i(4),R(p(6,13,t)),i(2),l("id",e+"-"+t)("value",t)("checked",c.selectedRoles().has(t))}}function pe(n,o){if(n&1&&(r(0,"lgmj-accordion-item",9),T(1,13),r(2,"strong"),u(3),s(4,"gameBoxName"),s(5,"uppercase"),a(),M(),S(6,se,9,15,"label",14,_),a()),n&2){let t=o.$implicit,e=f();l("noInnerPadding",!0)("headerColor","light"),i(3),R(p(5,5,p(4,3,t))),i(3),N(e.boxContents[t])}}var G=class n{playerRoleNamePipe=d(v);cardChoiceState=d(j).state;router=d(k);formBuilder=d(Z);route=d(D);boxContents=ne;boxes=Object.values(h);loupGarouRole="LOUP_GAROU";villageoisRole="VILLAGEOIS";selectedRoles=C(()=>{let o=this.rolesSelectionChange()?.source?.selected??[];return new Set(o)});rolesSelection=new q(!0);rolesSelectionChange=O(this.rolesSelection.changed);requiredVillageois=C(()=>this.selectedRoles().has("VOLEUR")?2:0);roleCountForm=this.formBuilder.group({loupGarou:[0,b.min(0)],villageois:[0,b.min(this.requiredVillageois())]});roleCountFormChanges=O(this.roleCountForm.valueChanges);villageoisCount=C(()=>this.roleCountFormChanges()?.villageois??0);loupGarouCount=C(()=>this.roleCountFormChanges()?.loupGarou??0);playersCount=C(()=>this.selectedRoles().size+this.villageoisCount()+this.loupGarouCount()+(this.selectedRoles().has("SOEUR")?1:0)+(this.selectedRoles().has("FRERE")?2:0)-(this.selectedRoles().has("VOLEUR")?2:0));ngOnInit(){Object.values(this.boxContents).forEach(t=>{t.sort((e,c)=>this.playerRoleNamePipe.transform(e).localeCompare(this.playerRoleNamePipe.transform(c)))});let o=this.cardChoiceState();this.rolesSelection.setSelection(...o.selectedRoles),this.roleCountForm.patchValue(o)}onRoleCheckChange(o){if(this.rolesSelection.toggle(o),o==="VOLEUR"){let t=this.roleCountForm.value.villageois??0;this.rolesSelection.isSelected(o)?this.roleCountForm.patchValue({villageois:t+2}):this.roleCountForm.patchValue({villageois:Math.max(t-2,0)})}}validateRoles(){let o={selectedRoles:this.selectedRoles(),playersNumber:this.playersCount(),villageois:this.roleCountForm.value.villageois??0,loupGarou:this.roleCountForm.value.loupGarou??0};this.cardChoiceState.set(o),this.router.navigate(["players"],{relativeTo:this.route.parent})}deselectAll(){this.rolesSelection.clear(),this.roleCountForm.patchValue({villageois:0,loupGarou:0})}selectInput(o){o.target.select()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=F({type:n,selectors:[["lgmj-roles-page"]],features:[V([v])],decls:26,vars:31,consts:[["checkbox",""],[1,"form-container"],[3,"submit","formGroup"],[1,"form-group"],[1,"role-img",3,"ngSrc","alt","width","height"],["for","loupGarou"],["type","number",1,"form-control",3,"focus","formControl","min"],["for","villageois"],[3,"multi"],[3,"noInnerPadding","headerColor"],[1,"submit-block"],["type","submit",1,"btn","primary",3,"disabled"],["type","button",1,"btn","danger",3,"click","disabled"],["header",""],[1,"form-group",3,"for"],["type","checkbox",1,"form-control",3,"change","id","value","checked"]],template:function(t,e){t&1&&(r(0,"main",1)(1,"form",2),g("submit",function(){return e.validateRoles()}),r(2,"div",3),E(3,"img",4),s(4,"playerRoleImage"),s(5,"playerRoleName"),r(6,"label",5),u(7),s(8,"playerRoleName"),a(),r(9,"input",6),g("focus",function(m){return e.selectInput(m)}),a()(),r(10,"div",3),E(11,"img",4),s(12,"playerRoleImage"),s(13,"playerRoleName"),r(14,"label",7),u(15),s(16,"playerRoleName"),a(),r(17,"input",6),g("focus",function(m){return e.selectInput(m)}),a()(),r(18,"cdk-accordion",8),S(19,pe,8,7,"lgmj-accordion-item",9,_),a(),r(21,"section",10)(22,"button",11),u(23),a(),r(24,"button",12),g("click",function(){return e.deselectAll()}),u(25," D\xC9S\xC9LECTIONNER TOUT "),a()()()()),t&2&&(i(),l("formGroup",e.roleCountForm),i(2),l("ngSrc",p(4,19,e.loupGarouRole))("alt",p(5,21,e.loupGarouRole))("width",55)("height",55),i(4),R(p(8,23,e.loupGarouRole)),i(2),l("formControl",e.roleCountForm.controls.loupGarou)("min",0),i(2),l("ngSrc",p(12,25,e.villageoisRole))("alt",p(13,27,e.villageoisRole))("width",55)("height",55),i(4),R(p(16,29,e.villageoisRole)),i(2),l("formControl",e.roleCountForm.controls.villageois)("min",e.requiredVillageois()),i(),l("multi",!0),i(),N(e.boxes),i(3),l("disabled",e.playersCount()<=0||e.roleCountForm.invalid),i(),U(" VALIDER (",e.playersCount()," JOUEURS) "),i(),l("disabled",e.playersCount()<=0))},dependencies:[ee,J,z,Y,X,$,W,te,K,Q,w,re,ie,oe,v,H,y,B],styles:[".form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{align-items:center;display:flex;gap:var(--spacing-1);padding:var(--spacing-1)}.form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]:not(:last-child){border-bottom:1px solid var(--light-border-color)}.form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input.form-control[_ngcontent-%COMP%]{margin-left:auto}.form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input.form-control[type=number][_ngcontent-%COMP%]{border-radius:var(--input-radius);border:1px solid var(--main-text-color);font-size:var(--font-size-m);height:1rem;padding:var(--spacing-05);text-align:end;width:2rem}.form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input.form-control[type=checkbox][_ngcontent-%COMP%]{height:1.25rem;width:1.25rem}"],changeDetection:0})};export{G as default};
