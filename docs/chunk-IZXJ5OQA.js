import{a as T}from"./chunk-U4UTBI7T.js";import{$ as b,F as h,M as w,O as l,Q as j,W as i,Yb as k,Zb as f,c as m,f as g,fa as p,ga as u,pa as s}from"./chunk-GNHLBSKU.js";import{a,b as c}from"./chunk-7CGTOI24.js";var d=class{constructor(e,t){this.storageKey=e;this.defaultValue=t;this.storageService=i(T);this.injector=i(p);this.initializedSubject=new g;this.initialized$=this.initializedSubject.asObservable();this.state=s(this.defaultValue),this.initFromStorage()}convertStateToStored(e){return e}convertStoredToState(e){return e}initFromStorage(){this.storageService.get(this.storageKey).pipe(h()).subscribe(e=>{e!=null&&this.state.set(this.convertStoredToState(e)),this.initStorageSync(),this.initializedSubject.next(),this.initializedSubject.complete()})}initStorageSync(){f(()=>this.storageService.set(this.storageKey,this.convertStateToStored(this.state())),{injector:this.injector})}};var x=class r extends d{constructor(){super("store.cardChoice",{villageois:0,loupGarou:0,playersNumber:0,selectedRoles:new Set})}convertStateToStored(e){return c(a({},e),{selectedRoles:Array.from(e.selectedRoles)})}convertStoredToState(e){return c(a({},e),{selectedRoles:new Set(e.selectedRoles)})}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=j({token:r,factory:r.\u0275fac,providedIn:"root"})}};function C(r){r||(b(C),r=i(u));let e=new m(t=>r.onDestroy(t.next.bind(t)));return t=>t.pipe(w(e))}function R(r,e){let t=!e?.manualCleanup;t&&!e?.injector&&b(R);let v=t?e?.injector?.get(u)??i(u):null,y=D(e?.equal),o;e?.requireSync?o=s({kind:0},{equal:y}):o=s({kind:1,value:e?.initialValue},{equal:y});let S=r.subscribe({next:n=>o.set({kind:1,value:n}),error:n=>{if(e?.rejectErrors)throw n;o.set({kind:2,error:n})}});if(e?.requireSync&&o().kind===0)throw new l(601,!1);return v?.onDestroy(S.unsubscribe.bind(S)),k(()=>{let n=o();switch(n.kind){case 1:return n.value;case 2:throw n.error;case 0:throw new l(601,!1)}},{equal:e?.equal})}function D(r=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&r(e.value,t.value)}export{d as a,x as b,C as c,R as d};
